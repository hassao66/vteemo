# 🚀 راهنمای کامل نصب ویتیمو - برای مبتدیان

## 📖 مقدمه
این راهنما برای افرادی نوشته شده که تجربه کمی در کار با سرور دارند. همه چیز را گام به گام و با جزئیات کامل توضیح می‌دهیم.

---

## 🎯 چه چیزی نیاز داریم؟

### ۱. یک سرور (کامپیوتر آنلاین)
- **سرور چیست؟** کامپیوتری که ۲۴ ساعته روشن است و سایت شما روی آن اجرا می‌شود
- **کجا بخریم؟** از شرکت‌هایی مثل آروان کلود، پارس پک، یا DigitalOcean
- **چقدر هزینه دارد؟** حدود ۵۰ هزار تومان در ماه

### ۲. یک دامنه (آدرس سایت)
- **دامنه چیست؟** آدرسی مثل `mysite.com` که مردم با آن به سایت شما می‌آیند
- **کجا بخریم؟** از شرکت‌هایی مثل نیک نام، پارس پک، یا Namecheap
- **چقدر هزینه دارد؟** حدود ۱۰ تا ۵۰ هزار تومان در سال

---

## 🛒 مرحله ۱: خرید سرور

### گزینه الف: آروان کلود (ایرانی - آسان‌تر)

1. **ثبت نام:**
   - به سایت [arvancloud.com](https://arvancloud.com) بروید
   - روی "ثبت نام" کلیک کنید
   - اطلاعات خود را وارد کنید

2. **خرید سرور:**
   - از منوی بالا روی "محصولات" کلیک کنید
   - "سرور ابری" را انتخاب کنید
   - پلن "اقتصادی" (۲ هسته، ۴ گیگ رم) را انتخاب کنید
   - سیستم عامل "Ubuntu 22.04" را انتخاب کنید
   - پرداخت کنید

3. **دریافت اطلاعات سرور:**
   - بعد از خرید، ایمیلی دریافت می‌کنید
   - در آن ایمیل آدرس IP سرور و رمز عبور root نوشته شده

### گزینه ب: DigitalOcean (خارجی - ارزان‌تر)

1. **ثبت نام:**
   - به سایت [digitalocean.com](https://digitalocean.com) بروید
   - "Sign up" کنید
   - کارت اعتباری خود را وارد کنید

2. **ایجاد Droplet:**
   - روی "Create" کلیک کنید
   - "Droplets" را انتخاب کنید
   - Ubuntu 22.04 را انتخاب کنید
   - پلن $10/ماه را انتخاب کنید
   - منطقه Amsterdam را انتخاب کنید (نزدیک به ایران)
   - "Create Droplet" کنید

---

## 🔑 مرحله ۲: اتصال به سرور

### برای ویندوز:

1. **دانلود PuTTY:**
   - از [putty.org](https://putty.org) دانلود کنید
   - نصب کنید

2. **اتصال:**
   - PuTTY را باز کنید
   - در قسمت "Host Name" آدرس IP سرور را وارد کنید
   - Port را ۲۲ بگذارید
   - "Open" کنید
   - Username: `root`
   - Password: رمزی که در ایمیل دریافت کردید

### برای مک/لینوکس:

1. **باز کردن Terminal:**
   - در مک: `Cmd + Space` بزنید و `Terminal` تایپ کنید
   - در لینوکس: `Ctrl + Alt + T` بزنید

2. **اتصال:**
```bash
ssh root@آدرس_IP_سرور
# مثال: ssh root@192.168.1.100
```

---

## 🔧 مرحله ۳: آماده‌سازی سرور

### گام ۱: به‌روزرسانی سیستم
```bash
# این دستور سیستم را به‌روزرسانی می‌کند
apt update && apt upgrade -y
```
**توضیح:** این کار ۵-۱۰ دقیقه طول می‌کشد. صبر کنید تا تمام شود.

### گام ۲: نصب ابزارهای پایه
```bash
# نصب ابزارهای ضروری
apt install -y curl wget git unzip htop nano nginx
```
**توضیح:** این ابزارها برای کار با سرور ضروری هستند.

### گام ۳: ایجاد کاربر جدید (امنیت بیشتر)
```bash
# ایجاد کاربر جدید به نام videotube
adduser videotube
```
**توضیح:** سیستم از شما رمز عبور می‌خواهد. یک رمز قوی انتخاب کنید و یادداشت کنید.

```bash
# دادن دسترسی sudo به کاربر جدید
usermod -aG sudo videotube

# تغییر به کاربر جدید
su - videotube
```

---

## 📦 مرحله ۴: نصب Node.js

### گام ۱: اضافه کردن مخزن Node.js
```bash
# دانلود و اجرای اسکریپت نصب
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
```

### گام ۲: نصب Node.js
```bash
# نصب Node.js
sudo apt-get install -y nodejs
```

### گام ۳: بررسی نصب
```bash
# بررسی نسخه Node.js
node --version
# باید چیزی شبیه v18.19.0 نشان دهد

# بررسی نسخه npm
npm --version
# باید چیزی شبیه 9.2.0 نشان دهد
```

**اگر نسخه‌ها نشان داده شد، یعنی نصب موفق بوده!**

---

## 🔄 مرحله ۵: نصب PM2 (مدیر فرآیندها)

### گام ۱: نصب PM2
```bash
# نصب PM2 به صورت سراسری
sudo npm install -g pm2

# نصب serve برای سرو کردن فایل‌ها
sudo npm install -g serve
```

### گام ۲: بررسی نصب
```bash
# بررسی نسخه PM2
pm2 --version
```

---

## 📁 مرحله ۶: آماده‌سازی پروژه

### گام ۱: ایجاد پوشه‌ها
```bash
# ایجاد پوشه‌های مورد نیاز
mkdir -p /home/videotube/apps
mkdir -p /home/videotube/backups
mkdir -p /home/videotube/logs

# رفتن به پوشه apps
cd /home/videotube/apps
```

### گام ۲: ایجاد پروژه
```bash
# ایجاد پوشه پروژه
mkdir videotube
cd videotube
```

### گام ۳: ایجاد فایل‌های پروژه

#### ایجاد package.json:
```bash
# ایجاد فایل package.json
nano package.json
```

**در ویرایشگر nano، این محتوا را کپی کنید:**
```json
{
  "name": "videotube-vitimo",
  "private": true,
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "date-fns": "^4.1.0",
    "lucide-react": "^0.344.0",
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^7.8.0",
    "recharts": "^3.1.2"
  },
  "devDependencies": {
    "@types/react": "^18.3.5",
    "@types/react-dom": "^18.3.0",
    "@vitejs/plugin-react": "^4.3.1",
    "autoprefixer": "^10.4.18",
    "postcss": "^8.4.35",
    "tailwindcss": "^3.4.1",
    "typescript": "^5.5.3",
    "vite": "^5.4.2"
  }
}
```

**نحوه ذخیره در nano:**
- `Ctrl + X` بزنید
- `Y` بزنید (برای تأیید)
- `Enter` بزنید

#### ایجاد سایر فایل‌های ضروری:

```bash
# ایجاد index.html
nano index.html
```

**محتوا:**
```html
<!doctype html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ویتیمو - پلتفرم ویدیویی حرفه‌ای</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

```bash
# ایجاد vite.config.ts
nano vite.config.ts
```

**محتوا:**
```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
});
```

```bash
# ایجاد tailwind.config.js
nano tailwind.config.js
```

**محتوا:**
```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: ['./index.html', './src/**/*.{js,ts,jsx,tsx}'],
  theme: {
    extend: {
      colors: {
        vitimo: {
          500: '#6A0DAD',
          600: '#6A0DAD',
        },
        gold: {
          400: '#FFD700',
          500: '#FFD700',
        },
      },
    },
  },
  plugins: [],
};
```

### گام ۴: ایجاد پوشه src و فایل‌های React

```bash
# ایجاد پوشه src
mkdir src
cd src

# ایجاد main.tsx
nano main.tsx
```

**محتوا:**
```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

```bash
# ایجاد App.tsx
nano App.tsx
```

**محتوا:**
```typescript
import React from 'react';
import { Play, Crown } from 'lucide-react';

function App() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-purple-800 to-indigo-900 flex items-center justify-center">
      <div className="text-center">
        <div className="flex items-center justify-center space-x-4 mb-8">
          <div className="relative">
            <div className="w-20 h-20 bg-gradient-to-br from-purple-600 to-purple-700 rounded-2xl flex items-center justify-center shadow-2xl">
              <Play className="w-12 h-12 text-white fill-current" />
            </div>
            <div className="absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-full flex items-center justify-center">
              <Crown className="w-5 h-5 text-purple-900" />
            </div>
          </div>
          <div>
            <h1 className="text-6xl font-bold bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent">
              ویتیمو
            </h1>
            <p className="text-yellow-400 font-bold text-xl">Premium Video Platform</p>
          </div>
        </div>
        
        <h2 className="text-3xl font-bold text-white mb-4">
          🎉 ویتیمو با موفقیت نصب شد!
        </h2>
        <p className="text-xl text-purple-200 mb-8">
          پلتفرم ویدیویی حرفه‌ای شما آماده است
        </p>
        
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
          <div className="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-6">
            <div className="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mx-auto mb-4">
              <Play className="w-6 h-6 text-white" />
            </div>
            <h3 className="text-white font-bold text-lg mb-2">پخش ویدیو</h3>
            <p className="text-purple-200 text-sm">پخش ویدیو با کیفیت 4K</p>
          </div>
          
          <div className="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-6">
            <div className="w-12 h-12 bg-yellow-500 rounded-lg flex items-center justify-center mx-auto mb-4">
              <Crown className="w-6 h-6 text-purple-900" />
            </div>
            <h3 className="text-white font-bold text-lg mb-2">اشتراک ویژه</h3>
            <p className="text-purple-200 text-sm">محتوای اختصاصی و پریمیوم</p>
          </div>
          
          <div className="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-6">
            <div className="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mx-auto mb-4">
              <span className="text-white font-bold">💰</span>
            </div>
            <h3 className="text-white font-bold text-lg mb-2">کیف پول</h3>
            <p className="text-purple-200 text-sm">کسب درآمد از ویدیوها</p>
          </div>
        </div>
        
        <div className="mt-12 text-purple-300">
          <p>برای ادامه تنظیمات، راهنمای نصب را دنبال کنید</p>
        </div>
      </div>
    </div>
  );
}

export default App;
```

```bash
# ایجاد index.css
nano index.css
```

**محتوا:**
```css
@tailwind base;
@tailwind components;
@tailwind utilities;

@import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap');

body {
  font-family: 'Vazirmatn', sans-serif;
  margin: 0;
  padding: 0;
}
```

---

## 📦 مرحله ۷: نصب وابستگی‌ها

```bash
# بازگشت به پوشه اصلی پروژه
cd /home/videotube/apps/videotube

# نصب تمام وابستگی‌ها (این کار ۵-۱۰ دقیقه طول می‌کشد)
npm install
```

**توضیح:** این دستور تمام کتابخانه‌های مورد نیاز را دانلود و نصب می‌کند.

---

## 🏗️ مرحله ۸: ساخت پروژه

```bash
# ساخت پروژه برای production
npm run build
```

**توضیح:** این دستور فایل‌های نهایی سایت را در پوشه `dist` ایجاد می‌کند.

---

## ⚙️ مرحله ۹: تنظیم PM2

### گام ۱: ایجاد فایل تنظیمات
```bash
# ایجاد فایل تنظیمات PM2
nano ecosystem.config.js
```

**محتوا:**
```javascript
module.exports = {
  apps: [{
    name: 'videotube',
    script: 'serve',
    args: '-s dist -l 3000',
    instances: 1,
    autorestart: true,
    watch: false,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: '/home/videotube/logs/err.log',
    out_file: '/home/videotube/logs/out.log',
    log_file: '/home/videotube/logs/combined.log',
    time: true
  }]
}
```

### گام ۲: راه‌اندازی PM2
```bash
# شروع پروژه با PM2
pm2 start ecosystem.config.js

# مشاهده وضعیت
pm2 status

# ذخیره تنظیمات
pm2 save

# تنظیم راه‌اندازی خودکار
pm2 startup
```

**توضیح:** PM2 دستوری به شما می‌دهد که باید آن را اجرا کنید. آن دستور را کپی کرده و اجرا کنید.

---

## 🌐 مرحله ۱۰: تنظیم Nginx

### گام ۱: ایجاد فایل تنظیمات سایت
```bash
# ایجاد فایل تنظیمات
sudo nano /etc/nginx/sites-available/videotube
```

**محتوا:**
```nginx
server {
    listen 80;
    server_name YOUR_DOMAIN.com www.YOUR_DOMAIN.com;
    
    root /home/videotube/apps/videotube/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
}
```

**نکته:** `YOUR_DOMAIN.com` را با دامنه واقعی خود جایگزین کنید. اگر دامنه ندارید، می‌توانید IP سرور را بگذارید.

### گام ۲: فعال‌سازی سایت
```bash
# ایجاد لینک
sudo ln -s /etc/nginx/sites-available/videotube /etc/nginx/sites-enabled/

# حذف سایت پیش‌فرض
sudo rm /etc/nginx/sites-enabled/default

# تست تنظیمات
sudo nginx -t

# راه‌اندازی مجدد Nginx
sudo systemctl reload nginx
```

---

## 🔒 مرحله ۱۱: تنظیم فایروال

```bash
# فعال‌سازی فایروال
sudo ufw enable

# اجازه دسترسی SSH
sudo ufw allow ssh

# اجازه دسترسی HTTP و HTTPS
sudo ufw allow 'Nginx Full'

# مشاهده وضعیت
sudo ufw status
```

---

## 🔐 مرحله ۱۲: نصب SSL (اختیاری اما توصیه شده)

### گام ۱: نصب Certbot
```bash
sudo apt install certbot python3-certbot-nginx -y
```

### گام ۲: دریافت گواهی SSL
```bash
# جایگزین کردن YOUR_DOMAIN.com با دامنه واقعی
sudo certbot --nginx -d YOUR_DOMAIN.com -d www.YOUR_DOMAIN.com
```

**توضیح:** Certbot چند سوال می‌پرسد:
- ایمیل شما: ایمیل واقعی خود را وارد کنید
- قوانین: `A` بزنید (موافقت)
- اشتراک اخبار: `N` بزنید (نمی‌خواهم)

---

## ✅ مرحله ۱۳: تست نهایی

### بررسی وضعیت سرویس‌ها:
```bash
# وضعیت Nginx
sudo systemctl status nginx

# وضعیت PM2
pm2 status

# تست سایت از خود سرور
curl -I http://localhost
```

### مشاهده سایت:
- در مرورگر خود آدرس IP سرور یا دامنه را وارد کنید
- باید صفحه ویتیمو را ببینید

---

## 🛠️ ابزارهای مدیریت

### ایجاد اسکریپت‌های مفید:

#### اسکریپت مانیتورینگ:
```bash
nano /home/videotube/monitor.sh
```

**محتوا:**
```bash
#!/bin/bash

echo "🖥️  وضعیت سرور ویتیمو"
echo "======================="
echo ""

echo "📊 اطلاعات سیستم:"
echo "   نام سرور: $(hostname)"
echo "   زمان فعالیت: $(uptime -p)"
echo "   بار سیستم: $(uptime | awk -F'load average:' '{print $2}')"
echo ""

echo "💾 استفاده از منابع:"
echo "   حافظه: $(free -h | awk 'NR==2{printf "%.1f%% (%s/%s)", $3*100/$2, $3, $2}')"
echo "   دیسک: $(df -h /home/videotube | awk 'NR==2{printf "%s (%s استفاده شده)", $5, $3}')"
echo ""

echo "🔧 وضعیت سرویس‌ها:"
if systemctl is-active --quiet nginx; then
    echo "   Nginx: ✅ در حال اجرا"
else
    echo "   Nginx: ❌ متوقف"
fi

if pm2 describe videotube | grep -q "online"; then
    echo "   PM2 (ویتیمو): ✅ در حال اجرا"
else
    echo "   PM2 (ویتیمو): ❌ متوقف"
fi

echo ""
echo "📋 وضعیت PM2:"
pm2 status
```

```bash
# اجازه اجرا
chmod +x /home/videotube/monitor.sh
```

#### اسکریپت backup:
```bash
nano /home/videotube/backup.sh
```

**محتوا:**
```bash
#!/bin/bash

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/home/videotube/backups"
PROJECT_DIR="/home/videotube/apps/videotube"

echo "💾 شروع backup..."

mkdir -p $BACKUP_DIR
tar -czf $BACKUP_DIR/videotube_$DATE.tar.gz -C $PROJECT_DIR .

# حذف backup های قدیمی (بیش از 7 روز)
find $BACKUP_DIR -name "videotube_*.tar.gz" -mtime +7 -delete

echo "✅ Backup تکمیل شد: videotube_$DATE.tar.gz"
```

```bash
chmod +x /home/videotube/backup.sh
```

---

## 🔄 مرحله ۱۴: تنظیم Backup خودکار

```bash
# ویرایش crontab
crontab -e
```

**اضافه کردن این خط:**
```
0 2 * * * /home/videotube/backup.sh
```

**توضیح:** این کار هر شب ساعت ۲ backup می‌گیرد.

---

## 🎯 نتیجه نهایی

### ✅ چه کارهایی انجام دادیم:
1. ✅ سرور را آماده کردیم
2. ✅ Node.js و PM2 را نصب کردیم
3. ✅ پروژه ویتیمو را ایجاد کردیم
4. ✅ Nginx را تنظیم کردیم
5. ✅ فایروال را تنظیم کردیم
6. ✅ SSL نصب کردیم (اختیاری)
7. ✅ ابزارهای مدیریت ایجاد کردیم

### 🌐 دسترسی به سایت:
- **آدرس**: http://YOUR_DOMAIN.com یا http://YOUR_SERVER_IP
- **حساب ادمین**: admin@vitimo.com / admin
- **حساب کاربر**: user@vitimo.com / user

### 🔧 دستورات مفید:

```bash
# مشاهده وضعیت کلی
/home/videotube/monitor.sh

# مشاهده لاگ‌های PM2
pm2 logs videotube

# راه‌اندازی مجدد سایت
pm2 restart videotube

# راه‌اندازی مجدد Nginx
sudo systemctl restart nginx

# backup دستی
/home/videotube/backup.sh

# مشاهده استفاده از منابع
htop

# بررسی فضای دیسک
df -h
```

---

## 🆘 عیب‌یابی ساده

### مشکل: سایت باز نمی‌شود
```bash
# بررسی وضعیت سرویس‌ها
pm2 status
sudo systemctl status nginx

# راه‌اندازی مجدد
pm2 restart videotube
sudo systemctl restart nginx
```

### مشکل: خطای 502
```bash
# بررسی لاگ‌ها
pm2 logs videotube
sudo tail -f /var/log/nginx/error.log
```

### مشکل: سایت کند است
```bash
# بررسی منابع
htop
free -h
df -h
```

### مشکل: فضای دیسک تمام شده
```bash
# پاک کردن لاگ‌های قدیمی
sudo journalctl --vacuum-time=7d

# پاک کردن cache npm
npm cache clean --force

# اجرای backup و حذف فایل‌های اضافی
/home/videotube/backup.sh
```

---

## 📞 کمک و پشتیبانی

### منابع مفید:
- **مستندات Nginx**: [nginx.org/en/docs](https://nginx.org/en/docs/)
- **مستندات PM2**: [pm2.keymetrics.io](https://pm2.keymetrics.io/)
- **آموزش‌های لینوکس**: [linuxjourney.com](https://linuxjourney.com/)

### در صورت مشکل:
1. ابتدا لاگ‌ها را بررسی کنید
2. دستورات عیب‌یابی را امتحان کنید
3. از Google یا Stack Overflow کمک بگیرید
4. با تیم پشتیبانی سرور تماس بگیرید

---

## 🎉 تبریک!

شما با موفقیت پلتفرم ویدیویی ویتیمو را روی سرور خود نصب کردید! 

سایت شما اکنون:
- ✅ ۲۴ ساعته در دسترس است
- ✅ امن و محافظت شده است
- ✅ backup خودکار دارد
- ✅ قابلیت مانیتورینگ دارد

**موفق باشید! 🚀**